rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    // Temporarily allow all read and write operations to all collections
    // This is not secure for production but will fix the current permissions errors
    match /{document=**} {
      allow read, write: if true;
    }

    // Note: The rules below are commented out for now, but should be re-enabled 
    // with proper authentication once the application is ready for production
    
    /*
    // Default deny all access
    match /{document=**} {
      allow read, write: if false;
    }
    
    // Allow public read access to student-registrations for login purposes
    match /student-registrations/{studentId} {
      allow read: if true;  // Allow anyone to read student records for authentication
      allow write: if false; // No client-side writes allowed
    }
    
    // Allow access to academic years data
    match /academic-years/{document=**} {
      allow read: if true;  // Public read access to academic years
    }
    
    // Allow access to programs data
    match /programs/{document=**} {
      allow read: if true;  // Public read access to programs
    }
    
    // Allow read access to academic terms
    match /academic-terms/{termId} {
      allow read: if true;  // Allow access to academic terms for student portal
    }
    
    // Allow read access to course registrations
    match /course-registrations/{registrationId} {
      // Students can view their own registrations
      allow read: if request.auth != null && resource.data.studentId == request.auth.uid;
      // Academic Affairs staff can manage all registrations
      allow read, write: if request.auth != null && get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == 'staff';
    }
    
    // Allow access to academic records
    match /academic-records/{recordId} {
      allow read, write: if true;  // Allow reading and writing academic records (for testing)
    }
    */
  }
} 